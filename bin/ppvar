#!/usr/bin/env zsh
# joopal-ppvar (ppvar)
#   pretty prints environment variables

function ppvar_main() {
  autoload -Uz echoer
  local var_name="${1:-PATH}"
  if [[ ! -v $var_name ]]; then
    echoer "ðŸš« variable '${var_name}' is not set ðŸš«"
    return 12
  fi

  local plines=$(trnl <<< "${(P)var_name}")
  local var_len=$(wc -l <<< ${plines[@]})

  local tempf=$(mktempf "ppvar-${var_name}")

  echoer $'Var name'   $'  ->' "${var_name}"                  #'\n'
  echoer $'Item count'   $'->' "$(trim-whitespace $var_len)"  #'\n'

  xargs -0 printf '%s' >&2 < $tempf
  rm "$tempf"

  printf "%s\n" "${plines[@]}" | trim-whitespace

  return 0
}

ppvar_main "$@"
