#!/usr/bin/env zsh
# joopal-ppvar (ppvar)
#   pretty prints environment variables
#
#   NOTE: $0  =  ~/bin/ppvar


autoload -Uz bin-abort ba-err echoer
trap 'bin-abort' ERR

autoload -Uz joopal-trim

local var_name="${1:-PATH}"
[[ -v "$var_name" ]] || \
    ba-err 12 '' "${0:t}" "\$$var_name" 'variable unset'

local plines=$(trnl <<< "${(P)var_name}")
local var_len=$(wc -l <<< ${plines[@]})

local tempf="`mktempf $0`"
exec 3>&2 2>"$tempf"
echoer                                                      #'\n'
echoer "${0:t} - pretty print shell env vars"               #'\n'
echoer $'\tvar name'   $'\t->' "${var_name}"                #'\n'
echoer $'\titem count' $'\t->' "$(joopal-trim $var_len)"    #'\n'

printf "%s\n" "${plines[@]}"

exec 2>&3 3>&-
xargs -0 printf '\n%s\n' >&2 < $tempf

