#/usr/bin/env zsh
# vim: ft=zsh foldmethod=marker:


# {{{ asdf
# INFO:  https://github.com/asdf-community/asdf-direnv#setup
# INFO: DEPRECATED
#source "$(asdf direnv hook asdf)"
# Uncomment the following line to make direnv silent by default.
# export DIRENV_LOG_FORMAT=""
# }}}


# {{{ Node.js
# INFO: https://github.com/direnv/direnv/wiki/Node#using-nvm
function use_nvm() {
  local node_version=$1
  unset npm_config_prefix

  nvm_sh=~/.nvm/nvm.sh
  if [[ -e $nvm_sh ]]; then
    source $nvm_sh
    nvm use $node_version
  fi
}
# }}}


# {{{ Python
# INFO: @zfogg remix
use_python() {
  if [ -n "$(which asdf)" ]; then
    local pyversion=$1
    asdf local python ${pyversion}
  fi
}

layout_uv() {
    if [[ -d ".venv" ]]; then
        VIRTUAL_ENV="$(pwd)/.venv"
    fi

    if [[ -z $VIRTUAL_ENV || ! -d $VIRTUAL_ENV ]]; then
        log_status "No virtual environment exists. Executing \`uv venv\` to create one."
        uv venv
        VIRTUAL_ENV="$(pwd)/.venv"
    fi

    PATH_add "$VIRTUAL_ENV/bin"
    export UV_ACTIVE=1  # or VENV_ACTIVE=1
    export VIRTUAL_ENV
}
# }}}


# {{{ Ruby
# INFO: https://github.com/direnv/direnv/wiki/Ruby
function use_ruby() {
  local ruby_root=$HOME/.rubies/$1
  load_prefix "$ruby_root"
  layout_ruby
}
# }}}
